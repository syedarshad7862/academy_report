sheets_data = {'Attendance report': [
['Session Date', '02-12-2024', '03-12-2024', '04-12-2024', '05-12-2024', '06-12-2024', '07-12-2024', '08-12-2024', '09-12-2024', '10-12-2024', '11-12-2024', '12-12-2024', '13-12-2024', None, None, None, None, None, None], 
['Session Number', 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, None, None, None, None, None, None],
 [None, None, None, None, None, None, None, None, None, None, None, None, None, None, 'Scheduled', None, None, None, None],
['Student Name', 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, None, 11, None, None, None, None],
 [None, None, None, None, None, None, None, None, None, None, None, None, None, None, 'Attended', 'Percentage', None, None, None],
 ['JISNA JOSEPH ', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, None, 0, 0, None, None, None],
 ['SYEDA AFEEFA', 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, None, 11, 1, None, None, None],
 ['SUDIR', 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, None, 9, '81.82%', None, None, None],
 ['NIKHATH FATIMA', 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, None, 10, '90.91%', None, None, None],
 ['SHOEBUDDIN AFZAL', 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, None, 11, 1, None, None, None],
 ['SYED DASTAGEER PASHA', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, None, 0, 0, None, None, None],
 ['NEMATH', 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, None, 11, 1, None, None, None],
 ['SHAIK AZHARUDDIN ', 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, None, 9, '81.82%', None, None, None],
 ['AFZAAL AHMED', 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, None, 10, '90.91%', None, None, None],
 ['ARSHIYA SHABNAM', 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, None, 11, 1, None, None, None],
 ['ZAID PARKAR ', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, None, 0, 0, None, 
None, None],
 ['SHAHID HAJWANI', 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, None, 11, 1, None, None, None],
 ['MOHAMMED FARHAN ALI', 1, 0, 1, 1, 1, 1, 1, 0, 1, 
1, 1, 0, None, 9, '81.82%', None, None, None]],
 'Assignment report': [
['Assignment Date', None, None, None, None, None, None, None, None, None, None, None],
 ['Assignment Name', 'CMAP2-A02-A01', 'CMAP2-A02-A02', 'CMAP2-A02-A03', 'CMAP2-A02-A04', 'CMAP2-A02-A05', None, None, None, None, None, None],
 [None, None, None, None, None, None, 'Due', None, None, None, 'Rating', 'Action Needed'],
 ['Student Name', 1, 1, 1, 1, 1, 5, None, None, None, None, None],
 [None, None, None, None, None, None, 'Submitted', 'Percentage', None, '90% -100%', 'Excllent', 'Keep up the good work'],
 ['JISNA JOSEPH ', 0, 0, 0, 0, 0, 0, 0, None, '75% - 89%', 'Average', 'Take the assignments which were missed'],
 ['SYEDA AFEEFA', 1, 1, 1, 1, 1, 5, 1, None, 'Below 75%', 'Poor', 'Talk to your mentor immediately'],
 ['SUDIR', 1, 0, 1, 1, 1, 4, '80.00%', None, None, None, None],
 ['NIKHATH FATIMA', 0, 1, 1, 1, 1, 4, '80.00%', None, 'Assignment/s are to be submitted.', 'Submission Rating', 'Deadline'],
 ['SHOEBUDDIN AFZAL', 1, 1, 1, 1, 1, 5, 1, None, 'CMAP2-A02-A01', 'Poor', 'Immediate'],
 ['SYED DASTAGEER PASHA', 0, 0, 0, 0, 0, 0, 0, None, 'CMAP2-A02-A02', 'Poor', 'Immediate'],
 ['NEMATH', 1, 1, 1, 1, 1, 5, 1, None, 'CMAP2-A02-A03', 'Poor', 'Immediate'],
 ['SHAIK AZHARUDDIN ', 1, 0, 1, 1, 1, 4, '80.00%', None, 'CMAP2-A02-A04', 'Poor', 'Immediate'],
 ['AFZAAL AHMED', 0, 1, 1, 1, 1, 4, '80.00%', None, 'CMAP2-A02-A05', 'Poor', 'Immediate'],
 ['ARSHIYA SHABNAM', 1, 1, 1, 1, 1, 5, 1, None, None, None, None],
 ['ZAID PARKAR ', 0, 0, 0, 0, 0, 0, 0, None, None, None, None],
 ['SHAHID HAJWANI', 1, 1, 1, 1, 1, 5, 1, None, None, 'Excellent ', 'Within a week'],
 ['MOHAMMED FARHAN ALI', 1, 0, 1, 1, 1, 4, '80.00%', None, None, 'Average', 'Within the next three days'],
 [None, None, None, None, None, None, None, None, None, None, 'Poor', 'Immediate'],
 [None, None, None, None, None, None, None, None, None, None, 'Poor', 'Immediate'],
 [None, None, None, None, None, None, None, None, None, None, 'Poor', 'Immediate']],
 'Mock Test Report': [['Mock Test Date', None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None],
 ['Mock Test Name', 'CMAP2-A02-Mock Test -001', 'CMAP2-A02-Mock Test -002', 'CMAP2-A02-Mock Test -003', 'CMAP2-A02-Mock Test -004', 'CMAP2-A02-Mock Test -005', None, None, None, None, None, None, None, None, None, None, None, None, None],
 [None, None, None, None, None, None, 'Due', None, None, None, None, None, None, None, None, None, None, None, None],
 ['Student Name', 1, 1, 1, 1, 1, 5, None, None, None, None, None, None, None, None, None, None, None, None],
 [None, None, None, None, None, None, 'Attended', 'Percentage', None, None, None, None, None, None, None, None, None, None, None],
 ['JISNA JOSEPH ', 0, 0, 0, 0, 0, 0, 0, None, None, None, None, None, None, None, None, None, None, None],
 ['SYEDA AFEEFA', 'E', 'D', 'C', 'B', 'A', 5, 1, None, None, None, None, None, None, None, None, None, None, None],
 ['SUDIR', 'E', 0, 'A', 'C', 'A', 5, 1, None, None, None, None, None, None, None, None, None, None, None],
 ['NIKHATH FATIMA', 0, 'B', 'B', 'A', 'A', 4, '80.00%', None, None, None, None, None, None, None, None, None, None, None], 
['SHOEBUDDIN AFZAL', 'E', 'C', 'C', 'B', 'A', 5, 1, None, None, None, None, None, None, None, None, None, None, None],
 ['SYED DASTAGEER PASHA', 0, 0, 0, 0, 0, 0, 0, None, None, None, None, None, None, None, None, None, None, None],
 ['NEMATH', 'E', 'A', 'D', 'C', 'B', 5, 1, None, None, None, None, None, None, None, None, None, None, None],
 ['SHAIK AZHARUDDIN ', 'E', 0, 'E', 'A', 'C', 4, '80.00%', None, None, None, None, None, None, None, None, None, None, None],
 ['AFZAAL AHMED', 0, 'C', 'A', 'B', 'A', 4, '80.00%', None, None, None, None, None, None, None, None, None, None, None],
 ['ARSHIYA SHABNAM', 'E', 'B', 'B', 'A', 'B', 5, 1, None, None, None, None, None, None, None, None, None, None, None],
 ['ZAID PARKAR ', 0, 0, 0, 0, 0, 0, 0, None, None, None, None, None, None, None, None, None, None, None],
 ['SHAHID HAJWANI', 'E', 'E', 'C', 'C', 'A', 5, 1, None, None, None, None, None, None, None, None, None, None, None],
 ['MOHAMMED FARHAN ALI', 'E', 0, 'D', 'A', 'B', 4, '80.00%', None, None, None, None, None, None, None, None, None, None, None]]}

def parse_mock_test_report(data):
    # Extract assignment names
    mock_test_names = data[1][1:6]  # Get the columns for mock test names
    
    # Extract student data
    student_data = []
    for row in data[5:]:
        if row[0]:  # Check if the first cell (Student Name) exists
            student = {
                "name": row[0].strip(),
                "mock_test_grade": row[1:6],  # mock test submission status
                "total_due": row[6],
                "total_submitted": row[7],
            }
            student_data.append(student)
    
    return mock_test_names, student_data

# assignments, student_data = parse_assignment_report(sheets_data["Assignment report"])




def get_moct_test(mock_test_names, student):
    pending = []
    for mock_test, submitted in zip(mock_test_names, student["mock_test_grade"]):
        if submitted == 0 or submitted == "A" or submitted == "B" or submitted == "C" or submitted == "D" or submitted == "E":  # Check for unsubmitted (0)
            pending.append({
                "name": mock_test,
                "grade": student["mock_test_grade"],
                # "action_needed": student["action_needed"],
            })
            
    return pending



# Parse the data
mock_test_names, student_data = parse_mock_test_report(sheets_data['Mock Test Report'])
print(mock_test_names)
print(student_data)

# Select a student (e.g., "JISNA JOSEPH")
search_student_name = 'ZAID PARKAR' # student_name
mock_selected_student = next((s for s in student_data if s["name"] == search_student_name), None)

if mock_selected_student:
    mock_names = get_moct_test(mock_test_names, mock_selected_student)
    print(f"mock test  for {search_student_name}:")
    for g, mock_test in enumerate(mock_names):
        # print(f"- {assignment['name']} | Rating: {assignment['rating']} | Action: {assignment['action_needed']}")
        print(f"- {mock_test['name']} grade : {mock_test['grade'][g]}")
        
else:
    print(f"No data found for student: {search_student_name}")



# Example datasets
"""  
assignments = ["Name of the Assignment"] * 5  # Replace with actual assignment names
student_data = {
    'name': 'JISNA JOSEPH',
    'assignments': [0, 0, 0, 0, 0],  # 0 indicates unsubmitted
    'total_due': 5,
}
rating_data = [
    {"rating": "Excellent", "min": 90, "max": 100, "action": "Keep up the good work", "deadline": "Within a week"},
    {"rating": "Average", "min": 75, "max": 89, "action": "Take the assignments which were missed", "deadline": "Within the next three days"},
    {"rating": "Poor", "min": 0, "max": 74, "action": "Talk to your mentor immediately", "deadline": "Immediate"},
]

# Function to generate the output table
def generate_table(assignments, student, rating_data):
    # Filter unsubmitted assignments
    mock_names = [
        {"assignment": assignment, "rating": rating_data[-1]}  # Default to "Poor"
        for assignment, submitted in zip(assignments, student['assignments']) if not submitted
    ]

    # Match ratings (if needed for each pending assignment)
    # For simplicity, we assume all unsubmitted assignments fall under the last rating (Poor).
    # You can extend this logic to match scores with ratings.

    # Create the table rows
    table_data = []
    for pending in mock_names:
        table_data.append([
            pending['assignment'],            # Assignment Name
            pending['rating']['rating'],      # Submission Rating
            pending['rating']['deadline'],    # Deadline
        ])

    return table_data

# Generate the table for the student
table = generate_table(assignments, student_data, rating_data)

# Print the table
print("Assignment/s are to be submitted. | Submission Rating | Deadline")
for row in table:
    print(f"{row[0]} | {row[1]} | {row[2]}")
    
"""    
